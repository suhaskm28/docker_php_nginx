# Use 1 worker process
worker_processes  1;

events { 
    worker_connections 1024;  # Max simultaneous connections per worker
}

http {
    include       mime.types;              # Support standard MIME types
    default_type  application/octet-stream; # Default if MIME not found
    sendfile        on;                    # Enable efficient file transfer
    keepalive_timeout  65;                 # Keep connections alive for 65s

    server {
        listen 80;                         # Listen on port 80 (HTTP)
        server_name localhost;             # Server name = localhost

        root /var/www/html;                # Root folder for app files
        index index.php index.html;        # Prioritize PHP index page

        location / {
            # If file exists serve it, else fall back to index.php
            try_files $uri $uri/ /index.php;
        }

        location ~ \.php$ {
            include fastcgi_params;        # Pass required CGI params
            fastcgi_pass 127.0.0.1:9000;   # Send PHP requests to PHP-FPM
            fastcgi_index index.php;       # Default PHP index file
            fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name; 
                                           # Correct file path handling
        }
    }
}
